#!/usr/bin/env bash
set -e

# Make sure the Zulip dev virtualenv exists, and operate within it.
if [ ! -d /srv/zulip-py3-venv ]; then
    ./tools/setup/setup_venvs.py
fi

# Zulip runs under Python3:
source /srv/zulip-py3-venv/bin/activate
pip-compile-multi -n common -n dev -n docs -n mypy -n prod
deactivate

# Thumbor runs under Python2:
source /srv/zulip-thumbor-venv/bin/activate
pip-compile-multi -n thumbor
