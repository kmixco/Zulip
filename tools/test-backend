#!/usr/bin/env bash
set -e

target='zerver'

case "$1" in
    zerver*)
      target="$1"
      shift
      ;;
esac

cd "$(dirname "$0")"/..
./tools/generate-fixtures
# "-u" uses unbuffered IO, which is important when wrapping it in subprocess
export PYTHONUNBUFFERED="y"
/usr/bin/env python2.7 ./manage.py test "$target" --settings=zproject.test_settings "$@"
